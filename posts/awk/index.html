<!DOCTYPE html>
<html><head>
<title>awk</title>


<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes">


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://rsms.me" crossorigin>


<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,700;1,400;1,700&family=JetBrains+Mono&display=swap">
<link rel="stylesheet" href="https://rsms.me/inter/inter.css">



<link rel="stylesheet" href="/css/main.min.7a8dc5b063775e5d3df0beea151395736f55ccb3343f70eea0595b53da5015c4.css">


<script defer src="/en.search.min.345f3bf5c63db4b5ac47276aa33caa54ae61fd2b71930188ed556bb7cc2a0e7f.js" integrity="sha256-NF879cY9tLWsRydqozyqVK5h/StxkwGI7VVrt8wqDn8="></script>


<link rel="stylesheet" href="/katex/katex.min.css" media="print" onload="this.media='all'">
<noscript><link rel="stylesheet" href="/katex/katex.min.css"></noscript>
<script defer src="/katex/katex.min.js"></script>
<script defer src="/katex/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
</head>
<body><header>
    <div class="header-main">
        <a href="/" id="logo">
            <img src="/svg/icon.svg" alt="icon" id="raccoon" />
        </a>
        <h3 class="site-title">عجفت الغور</h3>
        <div id="search">
            
<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>

        </div>
    </div>
    <nav id="breadcrumb" aria-label="Note trail"><span class="trail-label">trail</span><span class="trail-crumbs"></span></nav>
</header>

<div class="layout-container">
  <div class="grid-container">
    <div class="grid">
      <div class="page" data-level="1">
        <div class="content">
            <h1>awk</h1>
            


            <p>Tags: <a href="/posts/computers/">computers</a></p>
<ul>
<li><a href="https://ferd.ca/awk-in-20-minutes.html">https://ferd.ca/awk-in-20-minutes.html</a></li>
<li>example: <a href="https://github.com/ferd/recon/blob/master/script/queue_fun.awk">https://github.com/ferd/recon/blob/master/script/queue_fun.awk</a></li>
<li>another: <a href="http://c2.com/doc/expense/">http://c2.com/doc/expense/</a></li>
<li><a href="https://www.youtube.com/watch?v=43BNFcOdBlY">https://www.youtube.com/watch?v=43BNFcOdBlY</a></li>
<li><a href="https://www.youtube.com/watch?v=4UGLsRYDfo8">https://www.youtube.com/watch?v=4UGLsRYDfo8</a></li>
</ul>
<h2 id="structure">Structure</h2>
<ul>
<li>
<p>Everything in awk is a pattern -&gt; action</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-awk" data-lang="awk"><span style="display:flex;"><span><span style="color:#a6e22e">Pattern1</span> { <span style="color:#a6e22e">ACTIONS</span>; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Pattern2</span> { <span style="color:#a6e22e">ACTIONS</span>; }
</span></span></code></pre></div></li>
<li>
<p>Each line will go through each of the patterns, one at a time</p>
</li>
</ul>
<h2 id="data-types">Data Types</h2>
<ul>
<li>awk only has strings and numbers</li>
<li>strings can be cast into numbers</li>
<li>both can be assigned to variables in <code>ACTIONS</code> with the <code>=</code> operator</li>
<li>variables can be declared anywhere, uninitialized variables have <code>&quot;&quot;</code> empty string value</li>
<li>awk has unidimensional associative arrays
<ul>
<li><code>var[key] = value</code></li>
</ul>
</li>
<li>can simulate multidimensional arrays, but not very good</li>
</ul>
<h2 id="patterns">Patterns</h2>
<h3 id="regular-and-boolean-expressions">Regular and Boolean Expressions</h3>
<ul>
<li>supports non-<a href="/posts/pcre/">pcre</a> regex (<code>gawk</code> might)</li>
<li>patterns can&rsquo;t capture specific groups, only to match</li>
<li>boolean expressions have <code>&amp;&amp;</code> <code>||</code> and <code>!</code></li>
<li>note that <code>==</code> does fuzzy matching (like js)</li>
<li>booleans can be used alongside regex</li>
</ul>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-awk" data-lang="awk"><span style="display:flex;"><span><span style="color:#e6db74">/admin/</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">debug</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">true</span> { <span style="color:#a6e22e">ACTION</span> }
</span></span></code></pre></div><ul>
<li>specific string matching against regex can use <code>~</code> or <code>!~</code></li>
<li>can also just use <code>{ACTIONS}</code> to have it run against every line</li>
</ul>
<h3 id="special-patterns">Special Patterns</h3>
<ul>
<li><code>BEGIN</code> matches only <em>before</em> any line has been input to the file, can initiate variables and other state</li>
<li><code>END</code> lets you do some final cleanup</li>
<li><em>Fields</em> see below</li>
</ul>
<h4 id="fields">Fields</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-awk" data-lang="awk"><span style="display:flex;"><span><span style="color:#75715e"># According to the following line</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># $1         $2    $3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 00:34:23   GET   /foo/bar.html</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># \_____________  _____________/</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#               $0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Hack attempt?</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">/admin.html$/</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">$</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;DELETE&#34;</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;Hacker Alert!&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>Fields are default separated by whitespace</li>
<li>You can modify the line by assigning to the field</li>
</ul>
<h2 id="actions">Actions</h2>
<p>Many possible actions, most useful ones:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-awk" data-lang="awk"><span style="display:flex;"><span>{ <span style="color:#66d9ef">print</span> <span style="color:#f92672">$</span><span style="color:#ae81ff">0</span>; }  <span style="color:#75715e"># prints $0. In this case, equivalent to &#39;print&#39; alone</span>
</span></span><span style="display:flex;"><span>{ <span style="color:#66d9ef">exit</span>; }      <span style="color:#75715e"># ends the program</span>
</span></span><span style="display:flex;"><span>{ <span style="color:#a6e22e">next</span>; }      <span style="color:#75715e"># skips to the next line of input</span>
</span></span><span style="display:flex;"><span>{ <span style="color:#a6e22e">a</span><span style="color:#f92672">=$</span><span style="color:#ae81ff">1</span>; <span style="color:#a6e22e">b</span><span style="color:#f92672">=$</span><span style="color:#ae81ff">0</span> } <span style="color:#75715e"># variable assignment</span>
</span></span><span style="display:flex;"><span>{ <span style="color:#a6e22e">c</span>[<span style="color:#f92672">$</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#f92672">$</span><span style="color:#ae81ff">2</span> } <span style="color:#75715e"># variable assignment (array)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{ <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">BOOLEAN</span>) { <span style="color:#a6e22e">ACTION</span> }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">BOOLEAN</span>) { <span style="color:#a6e22e">ACTION</span> }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span> { <span style="color:#a6e22e">ACTION</span> }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>{ <span style="color:#66d9ef">for</span> (<span style="color:#a6e22e">i</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">x</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) { <span style="color:#a6e22e">ACTION</span> } }
</span></span><span style="display:flex;"><span>{ <span style="color:#66d9ef">for</span> (<span style="color:#a6e22e">item</span> <span style="color:#f92672">in</span> <span style="color:#a6e22e">c</span>) { <span style="color:#a6e22e">ACTION</span> } }
</span></span></code></pre></div><p>ALL VARIABLES ARE GLOBAL</p>
<h3 id="functions">Functions</h3>
<p>Functions can be called with typical syntax <code>{ somecall($2) }</code></p>
<p>Built-in functions: <a href="https://www.gnu.org/software/gawk/manual/html_node/Built_002din.html#Built_002din">https://www.gnu.org/software/gawk/manual/html_node/Built_002din.html#Built_002din</a></p>
<p>User defined functions:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-awk" data-lang="awk"><span style="display:flex;"><span><span style="color:#75715e"># function arguments are call-by-value</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">name</span>(<span style="color:#a6e22e">parameter</span><span style="color:#f92672">-</span><span style="color:#a6e22e">list</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ACTIONS</span>; <span style="color:#75715e"># same actions as usual</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># return is a valid keyword</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">add1</span>(<span style="color:#a6e22e">val</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">val</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="special-variables">Special Variables</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-awk" data-lang="awk"><span style="display:flex;"><span>BEGIN { <span style="color:#75715e"># Can be modified by the user</span>
</span></span><span style="display:flex;"><span>  FS <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;,&#34;</span>;   <span style="color:#75715e"># Field Separator</span>
</span></span><span style="display:flex;"><span>  RS <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;\n&#34;</span>;  <span style="color:#75715e"># Record Separator (lines)</span>
</span></span><span style="display:flex;"><span>  OFS <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; &#34;</span>;  <span style="color:#75715e"># Output Field Separator</span>
</span></span><span style="display:flex;"><span>  ORS <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;\n&#34;</span>; <span style="color:#75715e"># Output Record Separator (lines)</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>{ <span style="color:#75715e"># Can&#39;t be modified by the user</span>
</span></span><span style="display:flex;"><span>  NF          <span style="color:#75715e"># Number of Fields in the current Record (line)</span>
</span></span><span style="display:flex;"><span>  NR          <span style="color:#75715e"># Number of Records seen so far</span>
</span></span><span style="display:flex;"><span>  ARGV <span style="color:#f92672">/</span> ARGC <span style="color:#75715e"># Script Arguments</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
            




   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   




        </div>
      </div>
    </div>
  </div>
  

<nav id="toc" class="toc-sidebar">
  <div class="toc-content">
    <h2>Table of Contents</h2>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#structure">Structure</a></li>
    <li><a href="#data-types">Data Types</a></li>
    <li><a href="#patterns">Patterns</a>
      <ul>
        <li><a href="#regular-and-boolean-expressions">Regular and Boolean Expressions</a></li>
        <li><a href="#special-patterns">Special Patterns</a></li>
      </ul>
    </li>
    <li><a href="#actions">Actions</a>
      <ul>
        <li><a href="#functions">Functions</a></li>
      </ul>
    </li>
    <li><a href="#special-variables">Special Variables</a></li>
  </ul>
</nav>
  </div>
</nav>


</div>

<script src="/js/URI.js" type="text/javascript"></script>

<script src="/js/page.js" type="text/javascript"></script>
</body>
</html>
