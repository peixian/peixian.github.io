<!DOCTYPE html>
<html><title>operating systems</title>


<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes" />


<link rel="stylesheet" href="/css/main.min.532078bb650bec3433e8e9db19e0453faa66c9cc0ce761054558a91d87039e9d.css"/>
<script defer src="/en.search.min.f91ea1b61540413dd13bc41ecb5d94d8183ca3c244a1c78247917b36e400880e.js" integrity="sha256-&#43;R6hthVAQT3RO8Qey12U2Bg8o8JEoceCR5F7NuQAiA4="></script>

<link rel="stylesheet" href="/katex/katex.min.css" />
<script defer src="/katex/katex.min.js"></script>
<script defer src="/katex/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
<body><header>
    <a href="/" id="logo">
        <img src="/svg/icon.svg" alt="icon" id="raccoon" />

    </a>
    <h3 class="site-title">عجفت الغور</h3>
    <div id="search">
        
<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>

    </div>
</header>

<div class="grid-container">
  <div class="grid">
    <div class="page" data-level="1">
      <div class="content">
          <h1>operating systems</h1>

          <p>Tags: <a href="/posts/computers/">computers</a></p>
<ul>
<li><a href="https://dedis.cs.yale.edu/2010/det/">https://dedis.cs.yale.edu/2010/det/</a></li>
<li><a href="https://research.cs.wisc.edu/htcondor/description.html">https://research.cs.wisc.edu/htcondor/description.html</a></li>
<li><a href="https://lwn.net/Articles/293575/">https://lwn.net/Articles/293575/</a></li>
<li><a href="https://www.dragonflybsd.org/cgi/web-man?command=sys_checkpoint&amp;section=2">https://www.dragonflybsd.org/cgi/web-man?command=sys_checkpoint&amp;section=2</a></li>
<li><a href="https://www.dragonflybsd.org/cgi/web-man?command=checkpoint&amp;section=ANY">https://www.dragonflybsd.org/cgi/web-man?command=checkpoint&amp;section=ANY</a></li>
<li><a href="http://ithare.com/bringing-architecture-of-operating-systems-to-xxi-century-part-iv-first-draft/">http://ithare.com/bringing-architecture-of-operating-systems-to-xxi-century-part-iv-first-draft/</a></li>
</ul>
<h2 id="major-parts">Major Parts</h2>
<ul>
<li>Isolation between processes</li>
<li>Mobility (for mobile)</li>
<li>Security</li>
<li>Minimizing the overhead</li>
<li>Syscalls transition the privilage level
<ul>
<li>syscalls are like any regular procedure calls, but with a trap instruction</li>
<li>kernel agrees to put syscalls on well known locations</li>
</ul>
</li>
</ul>
<h3 id="trapping-and-untrapping-for-syscalls">Trapping and untrapping for syscalls</h3>
<ul>
<li>Process needs to save the program counter (PC)/instruction pointer (IP) which stores the address of the next instructino to be executed (for resuming)</li>
<li>Some flags about resuming execution on the CPU state</li>
<li>All of them get written onto a stack on the kernel side, which then pops back up</li>
</ul>
<h3 id="limited-direct-execution">Limited Direct Execution</h3>
<ol>
<li>At boot kernel initializes a trap table</li>
<li>When running a process, kernel sets up a trap and return of trap to switch back and forth to do syscalls</li>
</ol>
<h2 id="forms-of-concurrency-bugs">Forms of Concurrency Bugs</h2>
<ul>
<li>Atomicity violations</li>
<li>Order violation</li>
<li>Classical deadlock bugs
<ul>
<li>Conditions for a deadlock
<ol>
<li>Mutual exclusion</li>
<li>Hold and wait</li>
<li>No preemption</li>
<li>Circular wait</li>
</ol>
</li>
</ul>
</li>
</ul>
<h2 id="threads">Threads</h2>
<ul>
<li>
<p>Similar to a linux process that always run in the same memory</p>
<ul>
<li>own instruction pointer, and can be scheduled on different CPU&rsquo;s and executing different things on the same program</li>
<li>shares the process structure (execpt stacks)</li>
<li>linux threads have their own pid</li>
<li>solaris is completely thread based</li>
<li>in linux, a thread is a prococess without a thread</li>
<li>created with the clone() system call</li>
<li>treat as one process in some games, uses the thread group</li>
<li><code>getpid()</code> will tell you some info</li>
<li>syn and locks!</li>
<li>threads tend to be pretty fast, usually an async that does stuff in the background, and never switches off the task running state, spinning is TASK_RUN, but it&rsquo;s not waiting on IO but rather a lock</li>
<li>biggest reason to use over a fork is because you can do the same memory</li>
</ul>
</li>
<li>
<p><a href="/posts/linux/">linux</a> kernel only uses lightweight processes, or threads.</p>
<ul>
<li>Threads use <code>libc</code> to transition to kernel space, but posix threads originate from <code>libc</code> and <code>libpthread</code>. Note that the kernel only uses LWPs. However, at the kernel layer, since a userspace thread maps to a lwp, it doesn&rsquo;t really matter</li>
</ul>
<figure><img src="/ox-hugo/2024-02-11_19-16-26_screenshot.png"/>
    </figure>

</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>Debugger commands
<ul>
<li>GDB
<ul>
<li><code>info threads</code> -&gt; list threads</li>
<li><code>thread &lt;n&gt;</code> -&gt; switches between threads</li>
<li><code>thread apply all bt</code> -&gt; backtraces</li>
</ul>
</li>
<li>LLDB
<ul>
<li><code>thread list</code></li>
<li><code>thread select 1</code></li>
<li><code>thread backtrace all~/~bt all</code></li>
</ul>
</li>
</ul>
</li>
<li>Thread stacks
<ul>
<li>
<p>each thread has its own stack to store data, and we can dump it like normal</p>
</li>
<li>
<p>Stack tracing a thread is when a function A calls function B, and function B has a return address to where function A called it.</p>
<figure><img src="/ox-hugo/2024-02-11_19-18-17_screenshot.png"/>
        </figure>

</li>
</ul>
</li>
<li>Symbol files
<ul>
<li>Symbols provide mappings between memory address ranges and associated symbol names, if you don&rsquo;t have the symbols, you just have the current function</li>
</ul>
</li>
</ul>
<h2 id="concurrent-forward-progress">Concurrent Forward Progress</h2>
<ul>
<li>If your threads are preemptible, it&rsquo;s possible that they, while being preempted for another task, might come back to having less resources than before, since the preemption task might take a different amount of resources. How do we fix this?</li>
</ul>
<h2 id="nixos">NixOS</h2>
<ul>
<li><a href="https://grahamc.com/blog/erase-your-darlings/">https://grahamc.com/blog/erase-your-darlings/</a></li>
</ul>

          




   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   
      
   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   
      
   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   
      
   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   



  <div class="bl-section">
    <h4>Links to this note</h4>
    <div class="backlinks">
        <ul>
       
          <li><a href="/posts/aiken_et_al_deconstructing_process_isolation/">Aiken et al: Deconstructing Process Isolation</a></li>
       
          <li><a href="/posts/centos/">CentOS</a></li>
       
          <li><a href="/posts/parallel_computing_and_the_os/">parallel computing and the os</a></li>
       
     </ul>
    </div>
  </div>


      </div>
    </div>
  </div>
</div>

<script src="/js/URI.js" type="text/javascript"></script>

<script src="/js/page.js" type="text/javascript"></script>
</body>
</html>
