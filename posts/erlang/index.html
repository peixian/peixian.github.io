<!DOCTYPE html>
<html><head>
<title>erlang</title>


<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes">


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://rsms.me" crossorigin>


<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,700;1,400;1,700&family=JetBrains+Mono&display=swap">
<link rel="stylesheet" href="https://rsms.me/inter/inter.css">



<link rel="stylesheet" href="/css/main.min.7a8dc5b063775e5d3df0beea151395736f55ccb3343f70eea0595b53da5015c4.css">


<script defer src="/en.search.min.c6b5a1f04b175a2222b939734a4832a0612f48cde5b7d5ed62e1e408393e1137.js" integrity="sha256-xrWh8EsXWiIiuTlzSkgyoGEvSM3lt9XtYuHkCDk&#43;ETc="></script>


<link rel="stylesheet" href="/katex/katex.min.css" media="print" onload="this.media='all'">
<noscript><link rel="stylesheet" href="/katex/katex.min.css"></noscript>
<script defer src="/katex/katex.min.js"></script>
<script defer src="/katex/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
</head>
<body><header>
    <div class="header-main">
        <a href="/" id="logo">
            <img src="/svg/icon.svg" alt="icon" id="raccoon" />
        </a>
        <h3 class="site-title">عجفت الغور</h3>
        <div id="search">
            
<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>

        </div>
    </div>
    <nav id="breadcrumb" aria-label="Note trail"><span class="trail-label">trail</span><span class="trail-crumbs"></span></nav>
</header>

<div class="layout-container">
  <div class="grid-container">
    <div class="grid">
      <div class="page" data-level="1">
        <div class="content">
            <h1>erlang</h1>
            


            <p>Tags:  <a href="/posts/programming_languages/">programming languages</a></p>
<ul>
<li><a href="https://erlangexplained.com/index.php/about">https://erlangexplained.com/index.php/about</a></li>
<li><a href="https://learnyousomeerlang.com/">https://learnyousomeerlang.com/</a></li>
<li><a href="https://www.erlang-in-anger.com/">https://www.erlang-in-anger.com/</a></li>
<li><a href="https://blog.stenmans.org/theBeamBook/">https://blog.stenmans.org/theBeamBook/</a></li>
<li><a href="http://erlang.org/doc/reference_manual/introduction.html">http://erlang.org/doc/reference_manual/introduction.html</a></li>
<li><a href="https://ferd.ca/the-zen-of-erlang.html">https://ferd.ca/the-zen-of-erlang.html</a></li>
<li><a href="https://erlangforums.com/">https://erlangforums.com/</a></li>
<li><a href="https://medium.com/erlang-battleground">https://medium.com/erlang-battleground</a></li>
<li><a href="https://medium.com/erlang-battleground/property-based-testing-erlang-elixir-de72ad24966b">https://medium.com/erlang-battleground/property-based-testing-erlang-elixir-de72ad24966b</a></li>
<li><a href="https://github.com/stevana/armstrong-distributed-systems/blob/main/docs/erlang-is-not-about.md#user-content-fn-0-b236052c3934bd6f7ea3426445bf45af">https://github.com/stevana/armstrong-distributed-systems/blob/main/docs/erlang-is-not-about.md#user-content-fn-0-b236052c3934bd6f7ea3426445bf45af</a></li>
<li><a href="https://www.erlang-factory.com/conference/ErlangUserConference2011/speakers/ScottLystigFritchie">https://www.erlang-factory.com/conference/ErlangUserConference2011/speakers/ScottLystigFritchie</a></li>
<li><a href="https://adoptingerlang.org/docs/development/otp_high_level/">https://adoptingerlang.org/docs/development/otp_high_level/</a></li>
</ul>
<h2 id="erlang-otp-24-highlights">Erlang/OTP 24 Highlights</h2>
<ul>
<li><a href="https://blog.erlang.org/My-OTP-24-Highlights/#EEP-56-supervisor-automatic-shutdown">https://blog.erlang.org/My-OTP-24-Highlights/#EEP-56-supervisor-automatic-shutdown</a></li>
<li>removed 320k lines of code!</li>
</ul>
<h2 id="erlang-projects">Erlang Projects</h2>
<ul>
<li><a href="https://github.com/apache/couchdb">https://github.com/apache/couchdb</a></li>
</ul>
<h2 id="interop">Interop</h2>
<ul>
<li><a href="https://www.erlang.org/doc/tutorial/introduction.html">https://www.erlang.org/doc/tutorial/introduction.html</a></li>
</ul>
<h2 id="rustler">Rustler</h2>
<ul>
<li><a href="/posts/rust/">rust</a> bridge for erlang</li>
<li><a href="https://github.com/rusterlium/rustler">https://github.com/rusterlium/rustler</a></li>
</ul>
<h2 id="erlang-scaling-limitations">Erlang Scaling Limitations</h2>
<ul>
<li><a href="https://learnyousomeerlang.com/distribunomicon#burying-the-distribunomicon">https://learnyousomeerlang.com/distribunomicon#burying-the-distribunomicon</a></li>
<li><a href="https://www.youtube.com/watch?v=KrwhOkiifQ8">https://www.youtube.com/watch?v=KrwhOkiifQ8</a> - Partisan: high performance large scale distributed Erlang</li>
<li><a href="https://arxiv.org/abs/1802.02652">https://arxiv.org/abs/1802.02652</a></li>
<li><a href="https://www.dcs.gla.ac.uk/~amirg/publications/DE-Bench.pdf">https://www.dcs.gla.ac.uk/~amirg/publications/DE-Bench.pdf</a></li>
<li><a href="https://github.com/max-au/spg">https://github.com/max-au/spg</a></li>
<li><a href="https://max-au.com/peer/">https://max-au.com/peer/</a></li>
</ul>
<h2 id="json--json-dot-md--with-erlang"><a href="/posts/json/">json</a> with erlang</h2>
<ul>
<li><a href="https://vining.dev/posts/jerk">https://vining.dev/posts/jerk</a></li>
</ul>
<h2 id="supervisor-trees-for-golang--golang-dot-md">Supervisor Trees for <a href="/posts/golang/">golang</a></h2>
<ul>
<li><a href="https://www.jerf.org/iri/post/2930/">https://www.jerf.org/iri/post/2930/</a></li>
<li><a href="https://adoptingerlang.org/docs/development/supervision_trees/">https://adoptingerlang.org/docs/development/supervision_trees/</a></li>
</ul>
<h2 id="nif-issues">Nif Issues</h2>
<ul>
<li><a href="/posts/elixir/#monitoring-for-elixir">Monitoring for elixir</a></li>
<li><a href="https://github.com/massemanet/redbug">https://github.com/massemanet/redbug</a>
<ul>
<li><a href="https://code.google.com/archive/p/eper/wikis/redbug.wiki">https://code.google.com/archive/p/eper/wikis/redbug.wiki</a></li>
</ul>
</li>
<li><a href="https://www.erlang.org/doc/apps/tools/lcnt_chapter.html">https://www.erlang.org/doc/apps/tools/lcnt_chapter.html</a></li>
<li><a href="https://www.erlang.org/doc/man/scheduler.html#sample_all-0">https://www.erlang.org/doc/man/scheduler.html#sample_all-0</a></li>
<li><a href="https://erlangforums.com/t/find-out-whats-running-on-dirty-schedulers/2885/3">https://erlangforums.com/t/find-out-whats-running-on-dirty-schedulers/2885/3</a>
<ul>
<li><a href="https://erlangforums.com/t/detecting-blocked-dirty-i-o-schedulers/1116">https://erlangforums.com/t/detecting-blocked-dirty-i-o-schedulers/1116</a></li>
</ul>
</li>
<li><a href="https://www.erlang.org/doc/apps/erts/beamasm#linux-perf-support">https://www.erlang.org/doc/apps/erts/beamasm#linux-perf-support</a> - <a href="/posts/linux/">linux</a></li>
<li><a href="https://medium.com/@jlouis666/erlang-dirty-scheduler-overhead-6e1219dcc7">https://medium.com/@jlouis666/erlang-dirty-scheduler-overhead-6e1219dcc7</a></li>
<li><a href="https://blog.jola.dev/patterns-for-managing-ets-tables#menu">https://blog.jola.dev/patterns-for-managing-ets-tables#menu</a></li>
</ul>
<h3 id="enabling">Enabling</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#e6db74">:erlang</span><span style="color:#f92672">.</span>system_flag(<span style="color:#e6db74">:scheduler_wall_time</span>, <span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> <span style="color:#e6db74">:schedulers</span><span style="color:#f92672">.</span>get_sample()
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> <span style="color:#e6db74">:schedulers</span><span style="color:#f92672">.</span>get_sample()
</span></span><span style="display:flex;"><span><span style="color:#e6db74">:schedulers</span><span style="color:#f92672">.</span>utilization(a, b)
</span></span></code></pre></div><h2 id="emacs--emacs-dot-md"><a href="/posts/emacs/">emacs</a></h2>
<ul>
<li><a href="https://github.com/massemanet/distel">https://github.com/massemanet/distel</a>
<ul>
<li><a href="https://massemanet.github.io/distel/doc/distel/index.html">https://massemanet.github.io/distel/doc/distel/index.html</a></li>
</ul>
</li>
<li><a href="http://www.snookles.com/erlang/">http://www.snookles.com/erlang/</a></li>
</ul>
<h2 id="cowboy-web-server">Cowboy Web Server</h2>
<ul>
<li>
<p><a href="https://gist.github.com/weaversam8/c77fe1df5749d6eaa459d9e1b6f61d9d">https://gist.github.com/weaversam8/c77fe1df5749d6eaa459d9e1b6f61d9d</a> - fully documented stream handler</p>
<ul>
<li><a href="https://github.com/ninenines/cowboy/issues/1270">https://github.com/ninenines/cowboy/issues/1270</a></li>
</ul>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-erlang" data-lang="erlang"><span style="display:flex;"><span>-module(reference_stream_h).
</span></span><span style="display:flex;"><span>-behavior(cowboy_stream).
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-export([init<span style="color:#f92672">/</span><span style="color:#ae81ff">3</span>]).
</span></span><span style="display:flex;"><span>-export([data<span style="color:#f92672">/</span><span style="color:#ae81ff">4</span>]).
</span></span><span style="display:flex;"><span>-export([info<span style="color:#f92672">/</span><span style="color:#ae81ff">3</span>]).
</span></span><span style="display:flex;"><span>-export([terminate<span style="color:#f92672">/</span><span style="color:#ae81ff">3</span>]).
</span></span><span style="display:flex;"><span>-export([early_error<span style="color:#f92672">/</span><span style="color:#ae81ff">5</span>]).
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-record(state, {next}).
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">%%
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">%% Callback Functions
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">%%
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% This implementation was modeled from imetrics_cowboy_stream_h.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% This is a ready-to-use template that other stream handlers can be
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% based on.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% This function is called when the request is first received and the
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% headers are parsed and known.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>-spec init(cowboy_stream:<span style="color:#a6e22e">streamid</span>(), cowboy_req:<span style="color:#a6e22e">req</span>(), cowboy:<span style="color:#a6e22e">opts</span>())
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span> {cowboy_stream:<span style="color:#a6e22e">commands</span>(), #state{}}.
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">init</span>(StreamID, Req <span style="color:#f92672">=</span> #{ path :<span style="color:#f92672">=</span> Path }, Opts) <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% The state record here holds our &#34;Next&#34; tuple, which contains a reference
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">% to ourselves (module) and a state maintained by the cowboy_stream module.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">% It can be passed around opaquely.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    State0 <span style="color:#f92672">=</span> #state{},
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% When we&#39;re ready to invoke the next handler in the chain, we call
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">% cowboy_stream:init/3. It returns that &#34;Next&#34; tuple and a list of &#34;commands&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">% to send to the upstream HTTP process. Those commands are documented [here][0]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">%
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">% [0]: https://ninenines.eu/docs/en/cowboy/2.8/manual/cowboy_stream/#commands
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    {Commands0, Next} <span style="color:#f92672">=</span> cowboy_stream:<span style="color:#a6e22e">init</span>(StreamID, Req, Opts),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% We pass these commands thru our &#34;fold&#34; function, which allows us to iterate
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">% thru each command and modify it if necessary. We can also add new commands
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">% here or in that function if we want to. Ultimately, the list of commands is
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">% returned by this function, and passed to the next handler upstream (or cowboy,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">% which passes them to the client, if this is the last handler.)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    fold(Commands0, State0#state{next<span style="color:#f92672">=</span>Next}).
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% This function is called with the data sent in the request body. It can be called in
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% chunks, so make sure to check the &#34;IsFin&#34; flag to decide whether you&#39;ve received
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% all the data.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>-spec data(cowboy_stream:<span style="color:#a6e22e">streamid</span>(), cowboy_stream:<span style="color:#a6e22e">fin</span>(), cowboy_req:<span style="color:#a6e22e">resp_body</span>(), State)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span> {cowboy_stream:<span style="color:#a6e22e">commands</span>(), State} <span style="color:#66d9ef">when</span> State::#state{}.
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">data</span>(StreamID, IsFin, Data, State0<span style="color:#f92672">=</span>#state{next<span style="color:#f92672">=</span>Next0}) <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% Invoke the next stream handler in the chain.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    {Commands0, Next} <span style="color:#f92672">=</span> cowboy_stream:<span style="color:#a6e22e">data</span>(StreamID, IsFin, Data, Next0),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% Process any commands returned by downstream stream handlers.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    fold(Commands0, State0#state{next<span style="color:#f92672">=</span>Next}).
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% Any messages addressed to the stream will be sent to this function. Cowboy also uses
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% this function to inform stream handlers of internal events.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>-spec info(cowboy_stream:<span style="color:#a6e22e">streamid</span>(), any(), State)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span> {cowboy_stream:<span style="color:#a6e22e">commands</span>(), State} <span style="color:#66d9ef">when</span> State::#state{}.
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">info</span>(StreamID, Info, State0<span style="color:#f92672">=</span>#state{next<span style="color:#f92672">=</span>Next0}) <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% Invoke the next stream handler in the chain.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    {Commands0, Next} <span style="color:#f92672">=</span> cowboy_stream:<span style="color:#a6e22e">info</span>(StreamID, Info, Next0),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% Process any commands returned by downstream stream handlers.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    fold(Commands0, State0#state{next<span style="color:#f92672">=</span>Next}).
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% All streams will eventually be terminated and this function will be called. The
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% only time when terminate/3 is not called is when an error occurs in init/3 of
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% any stream handler, since the state is not available.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>-spec terminate(cowboy_stream:<span style="color:#a6e22e">streamid</span>(), cowboy_stream:<span style="color:#a6e22e">reason</span>(), #state{}) <span style="color:#f92672">-&gt;</span> any().
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">terminate</span>(StreamID, Reason, #state{next<span style="color:#f92672">=</span>Next}) <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% Propagate the terminate to downstream stream handlers.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    cowboy_stream:<span style="color:#a6e22e">terminate</span>(StreamID, Reason, Next).
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% This function will be called when an error occurs before the request-line and
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% all headers have been received in an HTTP/1.1 request. It includes the partial
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% request, and the response Cowboy intends to send. The return value of this
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% function is the response, so it allows you to modify it if necessary.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>-spec early_error(cowboy_stream:<span style="color:#a6e22e">streamid</span>(), cowboy_stream:<span style="color:#a6e22e">reason</span>(),
</span></span><span style="display:flex;"><span>    cowboy_stream:<span style="color:#a6e22e">partial_req</span>(), Resp, cowboy:<span style="color:#a6e22e">opts</span>()) <span style="color:#f92672">-&gt;</span> Resp
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">when</span> Resp::cowboy_stream:<span style="color:#a6e22e">resp_command</span>().
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">early_error</span>(StreamID, Reason, PartialReq, Resp, Opts) <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% Propagate the error to downstream stream handlers.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    cowboy_stream:<span style="color:#a6e22e">early_error</span>(StreamID, Reason, PartialReq, Resp, Opts).
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">%%
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">%% Internal Functions
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">%%
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% Any commands (see [0]) returned from downstream handlers are passed thru this
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% fold function, giving us the chance to modify, omit, replace, or append to them.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">%
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% This module transparently passes the commands thru without any changes, but this
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% logic remains in place since this is the best documented stream handler in all of
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% our codebases, and it should exist as a reference for other stream handlers to hook
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% into in the future.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">%
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% [0]: https://ninenines.eu/docs/en/cowboy/2.8/manual/cowboy_stream/#commands
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">fold</span>(Commands, State) <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>    fold(Commands, State, []).
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% At the end of the recursion, reverse the accumulator so the original order of
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% commands is preserved.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">fold</span>([], State, Acc) <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>    {lists:<span style="color:#a6e22e">reverse</span>(Acc), State};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% You can add additional cases here to catch specific commands.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% fold([{response, ResponseCode, Headers, Body0}|Tail], State0, Acc) -&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">%     % do something with the body
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">%     Body = do_something(Body0),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">%     Response = {response, ResponseCode, Headers, Body},
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">%     fold(Tail, State0, [Response|Acc]);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% This is the catch-all case for any commands we didn&#39;t match above, pass it
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">% thru unmodified.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">fold</span>([Command|Tail], State, Acc) <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>    fold(Tail, State, [Command|Acc]).
</span></span></code></pre></div></li>
</ul>
<h2 id="installing-on-m1">Installing on M1</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fish" data-lang="fish"><span style="display:flex;"><span><span style="color:#a6e22e">export</span> KERL_CONFIGURE_OPTIONS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--without-javac --with-ssl=</span>$(<span style="color:#e6db74">brew --prefix openssl@3) --without-odbc&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">asdf</span> install erlang <span style="color:#ae81ff">26</span>.<span style="color:#ae81ff">2</span>.<span style="color:#ae81ff">1</span>
</span></span></code></pre></div><h2 id="rust--rust-dot-md--killing-senders-by-sending-back-unexpected-responses"><a href="/posts/rust/">rust</a> Killing Senders by Sending Back Unexpected Responses</h2>
<ul>
<li><a href="https://news.ycombinator.com/item?id=40178652">https://news.ycombinator.com/item?id=40178652</a></li>
</ul>
<h2 id="dist">Dist</h2>
<ul>
<li>look for <code>erts_term</code> and other stuff</li>
<li>BEAM JIT&rsquo;d too, usually stuff like <code>beam_jit:binary_to_term</code></li>
<li>backwards forward compatibility?</li>
<li>how does dist look like on the wire?</li>
<li>visualizations of what dist looks like</li>
</ul>
<h2 id="scheduler">Scheduler</h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=tBAM_N9qPno">https://www.youtube.com/watch?v=tBAM_N9qPno</a></li>
<li>many tasks in a run queue, and counts reductions</li>
<li><a href="https://www.erlang.org/doc/apps/erts/erlang.html#process_flag_priority">https://www.erlang.org/doc/apps/erts/erlang.html#process_flag_priority</a> can be used to set priorirty</li>
<li>Ports do the same</li>
<li>1ms per core</li>
</ul>
<h2 id="busy-wait">Busy Wait</h2>
<ul>
<li><a href="https://gist.github.com/eiri/a87459acc05ea152d632">https://gist.github.com/eiri/a87459acc05ea152d632</a></li>
</ul>

            




   

   

   

   

   

   

   

   

   

   

   

   

   

   
      
   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   
      
   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   
      
   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   
      
   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   
      
   

   
      
   

   
      
   

   
      
   

   
      
   

   
      
   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   
      
   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   
      
   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   
      
   

   

   

   

   

   

   
      
   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   
      
   

   

   

   
      
   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   



  <div class="bl-section">
    <h4>Links to this note</h4>
    <div class="backlinks">
        <ul>
       
          <li><a href="/posts/2021_goals/">2021 goals</a></li>
       
          <li><a href="/posts/actor_model/">actor model</a></li>
       
          <li><a href="/posts/beam_vm/">beam vm</a></li>
       
          <li><a href="/posts/elixir_driver_for_cassandra_scylla/">elixir driver for cassandra/scylla</a></li>
       
          <li><a href="/posts/erlang_beam_vs_jvm/">erlang beam vs jvm</a></li>
       
          <li><a href="/posts/erlang_hot_reloading_post/">erlang hot reloading post</a></li>
       
          <li><a href="/posts/erlang_in_kubernetes/">erlang in kubernetes</a></li>
       
          <li><a href="/posts/erlang_jit/">erlang jit</a></li>
       
          <li><a href="/posts/erlang_live_market_parser_api_on_kubernetes/">erlang live market parser api on kubernetes</a></li>
       
          <li><a href="/posts/erlang_pg2_postmortem/">erlang pg2 postmortem</a></li>
       
          <li><a href="/posts/flatbuffers_project/">flatbuffers project</a></li>
       
          <li><a href="/posts/golang/">golang</a></li>
       
          <li><a href="/posts/herbert_erlang_in_anger/">Herbert - Erlang in Anger</a></li>
       
          <li><a href="/posts/high_performance_erlang_project_hipe/">high performance erlang project (HiPE)</a></li>
       
          <li><a href="/posts/runtimes/">runtimes</a></li>
       
          <li><a href="/posts/rust/">rust</a></li>
       
     </ul>
    </div>
  </div>


        </div>
      </div>
    </div>
  </div>
  

<nav id="toc" class="toc-sidebar">
  <div class="toc-content">
    <h2>Table of Contents</h2>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#erlang-otp-24-highlights">Erlang/OTP 24 Highlights</a></li>
    <li><a href="#erlang-projects">Erlang Projects</a></li>
    <li><a href="#interop">Interop</a></li>
    <li><a href="#rustler">Rustler</a></li>
    <li><a href="#erlang-scaling-limitations">Erlang Scaling Limitations</a></li>
    <li><a href="#json--json-dot-md--with-erlang"><a href="HAHAHUGOSHORTCODE555s2HBHB">json</a> with erlang</a></li>
    <li><a href="#supervisor-trees-for-golang--golang-dot-md">Supervisor Trees for <a href="HAHAHUGOSHORTCODE555s3HBHB">golang</a></a></li>
    <li><a href="#nif-issues">Nif Issues</a>
      <ul>
        <li><a href="#enabling">Enabling</a></li>
      </ul>
    </li>
    <li><a href="#emacs--emacs-dot-md"><a href="HAHAHUGOSHORTCODE555s6HBHB">emacs</a></a></li>
    <li><a href="#cowboy-web-server">Cowboy Web Server</a></li>
    <li><a href="#installing-on-m1">Installing on M1</a></li>
    <li><a href="#rust--rust-dot-md--killing-senders-by-sending-back-unexpected-responses"><a href="HAHAHUGOSHORTCODE555s7HBHB">rust</a> Killing Senders by Sending Back Unexpected Responses</a></li>
    <li><a href="#dist">Dist</a></li>
    <li><a href="#scheduler">Scheduler</a></li>
    <li><a href="#busy-wait">Busy Wait</a></li>
  </ul>
</nav>
  </div>
</nav>


</div>

<script src="/js/URI.js" type="text/javascript"></script>

<script src="/js/page.js" type="text/javascript"></script>
</body>
</html>
